# Microsoft365R-2.1.0-with-Outlook-support-now-on-CRAN

Here’s a sample of how to write an email using blastula:

library(Microsoft365R)

# 1st one is for your personal Microsoft account
# 2nd is for your work & school account
outl <- get_personal_outlook()
outlb <- get_business_outlook()

# compose an email with blastula
library(blastula)
bl_body <- "## Hello!

This is an email message that was generated by the blastula package.

We can use **Markdown** formatting with the `md()` function.

Cheers,

The blastula team"

bl_em <- compose_email(
    body=md(bl_body),
    footer=md("sent via Microsoft365R")
)
em <- outl$create_email(bl_em, subject="Hello from R",
                        to="bob@example.com")

# add an attachment and send it
em$add_attachment("mydocument.docx")
em$send()

And on the other side, here’s a sample of how to work with the emails in your inbox:

# list the most recent emails in your inbox
emlst <- outl$list_emails()

# get the most recent email
em <- emlst[[1]]

# list and download attachments
em$list_attachments()
em$download_attachment("mydatafile.csv")

# reply to it
em$create_reply("Replying from R")$send()

# list the folders in your account
outl$list_folders()

# move the move recent email to a given folder
folder <- outl$get_folder("My project folder")
em$move(folder)

In addition, this release fixes a bug in the list_files() method for OneDrive/Sharepoint drives and drive items, and adds the ability to create nested drive folders in one call.
